---
title: Agent Orchestration
revision_summary: Initial release
---

# SOP-007: Agent Orchestration

## 1. Purpose

This procedure establishes requirements for spawning, managing, and coordinating AI agents within the Quality Management System. It ensures separation of duties, reviewer independence, and auditable agent interactions.

---

## 2. Scope

This SOP applies to:

- The orchestrating agent (claude)
- All spawned subagents (QA, domain reviewers, and other agents defined in `.claude/agents/`)
- Agent-to-agent communications
- Agent interactions with the QMS CLI

**Out of Scope:**

- Human user interactions (see SOP-001)
- Document workflows (see SOP-001, SOP-002)

---

## 3. Definitions

| Term | Definition |
|------|------------|
| **Orchestrator** | The primary agent (claude) that spawns and coordinates subagents |
| **Subagent** | A spawned agent with a specific role (e.g., QA, domain reviewer, business unit representative) |
| **Task Prompt** | The instruction provided when spawning a subagent |
| **Context** | Information passed to a subagent about the work to be performed |
| **Review Independence** | The principle that reviewers derive criteria from SOPs and their domain expertise, not from orchestrator instructions |

---

## 4. Agent Roles and Responsibilities

### 4.1 Orchestrator Responsibilities

The orchestrator shall:

1. Spawn subagents appropriate to the task
2. Provide minimal context sufficient to identify the work (see Section 5)
3. Respect subagent independence in review and approval decisions
4. Reuse existing agents within a session (see Section 4.4)
5. Maintain accurate records of agent interactions via the audit trail

The orchestrator shall NOT:

1. Impersonate other agents when interacting with the QMS CLI
2. Override or circumvent subagent decisions
3. Spawn agents for the purpose of bypassing review requirements
4. Provide context that pre-determines reviewer judgment (see Section 5.2)

### 4.2 Subagent Responsibilities

Subagents shall:

1. Operate within their designated role and permissions
2. Derive review and approval criteria from governing SOPs
3. Exercise independent judgment in their domain
4. Report anomalies or concerns to the orchestrator or Lead

Subagents shall NOT:

1. Claim an identity other than their assigned role
2. Defer to orchestrator preferences over SOP requirements
3. Perform actions outside their permission scope

### 4.3 Agent Selection

The orchestrator shall select the appropriate agent type based on:

| Criterion | Consideration |
|-----------|---------------|
| Action required | Review, approval, technical assessment |
| Domain affected | UI, simulation, sketch, scene, business |
| SOP requirements | Workflow stage determines required reviewers |

### 4.4 Agent Reuse

Within a session, the orchestrator shall:

1. Reuse existing agents via resume when the same role is needed again
2. Track agent IDs for continuity throughout the session
3. NOT spawn fresh agents of the same type unless explicitly directed by the Lead

There is no valid rationale for "refreshing context" by spawning new agents. If context refresh is required, the Lead will direct it explicitly.

---

## 5. Communication Boundaries

### 5.1 Principle

Documents speak for themselves. The orchestrator shall provide minimal context when spawning subagents. Documents, SOPs, and agent definition files provide the necessary context for subagents to perform their work.

### 5.2 Permitted Context

When spawning a subagent, the orchestrator may provide:

- Document identification (e.g., CR-012, SOP-003)
- Current workflow state (status, version)
- Task type (review, approval, technical assessment)

### 5.3 Prohibited Context

When spawning a subagent, the orchestrator shall NOT provide:

- Summaries or interpretations of document content
- Specific review criteria or checklists
- Desired review outcomes (e.g., "approve if X, Y, Z are present")
- Instructions that pre-determine reviewer judgment
- Pressure or urgency that could compromise review quality
- Background information that the document itself should contain

### 5.4 Context Sources

Subagents shall derive context from:

| Source | Purpose |
|--------|---------|
| The document under review | Contains all relevant content for the task |
| QMS-controlled content | SOPs, templates, SDLC documents (RS, RTM, etc.) |
| Agent definition files | Define role, responsibilities, and behavioral directives |
| CLAUDE.md | Technical architecture guide |
| Relevant code | Source code within scope of the document being reviewed |

If a subagent lacks sufficient context to perform its task, this indicates a deficiency in the document or SOPs, not a need for orchestrator explanation.

### 5.5 Rationale

Review independence ensures that:

1. Reviewers apply SOP requirements consistently
2. The orchestrator cannot rubber-stamp its own work
3. Quality decisions are based on document merit, not orchestrator preference
4. Deficiencies in documents are surfaced rather than papered over with verbal context

---

## 6. Identity and Integrity

### 6.1 Identity Claims

Each agent shall:

1. Use only its assigned identity when interacting with the QMS CLI
2. Include its identity in the `--user` flag accurately
3. Not claim permissions beyond its role

### 6.2 Audit Trail

All agent actions are recorded in the QMS audit trail. Agents shall:

1. Accept that their actions are logged
2. Not attempt to manipulate or circumvent audit logging
3. Report any suspected audit trail anomalies

### 6.3 Prohibited Behaviors

Agents shall NOT:

1. Use scripting or tools to bypass CLI permission checks
2. Directly manipulate files in `QMS/.meta/` or `QMS/.audit/`
3. Craft workarounds that undermine document control
4. Access files outside the project directory without Lead authorization

If an agent discovers a way to circumvent the system, the agent shall report it rather than exploit it.

---

## 7. Conflict Resolution and Enforcement

### 7.1 Disagreement with Orchestrator

If a subagent disagrees with orchestrator guidance:

1. The subagent shall prioritize SOP requirements over orchestrator preferences
2. The subagent may document concerns in review comments
3. The subagent shall not be overridden on compliance matters

### 7.2 Escalation

Issues that cannot be resolved between agents shall be:

1. Documented in the relevant QMS document (review comments, execution notes)
2. Escalated to the Lead for resolution

### 7.3 Enforcement

Violations of this SOP are addressed through:

| Mechanism | Application |
|-----------|-------------|
| Audit trail review | Primary mechanism; all actions are logged and reviewable |
| Investigation (INV) | Only if the Lead determines one is warranted |

The audit trail provides sufficient visibility into agent behavior. Formal investigation is reserved for significant or systemic issues at the Lead's discretion.

---

## 8. References

| Document | Relationship |
|----------|--------------|
| SOP-001 | Document control lifecycle; user groups and permissions |
| SOP-002 | Change control workflow; review team requirements |
| CLAUDE.md | Orchestrator operational instructions; technical architecture |
| Agent definition files | Role-specific responsibilities and behavioral directives |

---

**END OF DOCUMENT**
